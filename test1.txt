Changes from Paul Hudson
and others too